---
title   : λ λ²¨2 μ¥λ°”κµ¬λ‹ ν‘μ—… with λ‹¤μ¦ ν—™ν¬
date    : 2023-05-23 14:13:31 +0900
updated : 2023-05-23 14:13:41 +0900
tags    : 
- μ°ν…μ½”
- λ λ²¨2
---

## νμ–΄ κ·μΉ™
- μ‹κ°„μ€ μ¬μ§€ μ•κ³  μ§„ν–‰ν•λ‹¤.
- κ¶κΈν• μ μ΄λ‚ μκ²¬μ€ μ–Έμ λ“ μ§€ μμ λ΅­κ² λ§ν•λ‹¤. λ¶„μ„κΈ°μ— λλ ¤κ°€μ§€ λ§κΈ°. 
- λ‘ λ‹¤ μΆ‹λ‹¤κ³  ν•μ§€ μ•κΈ° -> μ§„μ§ λ‘ λ‹¤ μΆ‹μ€ κ²½μ°μ—λ” κ°κ° μΆ‹μ€ μ΄μ λ¥Ό λ§ν•  κ²ƒ.
	- λ§μ μ†μ— λ­”κ°€ μ •λ‹µμ΄ μλ” κ²½μ°μ—λ” κ·Έλƒ¥ λ§ν•κΈ°.
- κ²½μ²­ μν•κΈ°.

### μ μ € λ°›μ•„μ„ λ³€κ²½ν•κΈ°

```shell
#!/bin/sh

# kill process
fuser -k 8080/tcp

# remove original code
rm -rf jwp-shopping-order

- [ ] # clone git main branch
git clone https://github.com/$1/jwp-shopping-order.git

# build
cd jwp-shopping-order
./gradlew bootJar

# execute
cd build/libs
nohup java -jar jwp-shopping-order.jar &
```

### pull λ΅ λ°”κΎΈκΈ°

- κΈ°μ΅΄μ— λ””λ ‰ν† λ¦¬κ°€ μ΅΄μ¬ν•λ©΄ pull, μ—†μΌλ©΄ clone

```shell
#!/bin/sh

# kill process
sudo fuser -k 80/tcp

# clone git main branch
if [ -d ~/jwp-shopping-order ]
then
	cd jwp-shopping-order
	git pull origin $2
else
	git clone https://github.com/$1/jwp-shopping-order.git
	cd jwp-shopping-order
fi

# build
./gradlew bootJar

# execute
cd build/libs
sudo nohup java -jar jwp-shopping-order.jar &
```

### https μ„¤μ •ν•κΈ°
- **λ„λ©”μΈ μ‚¬μ„ μ„¤μ • -> cloudfare** 
	- μ„λΈ λ„λ©”μΈ μ‚¬μ©

## 2λ‹¨κ³„

### ν•„μ κµ¬ν„ μ‚¬ν•­

- μ¶”κ°€λ  ν…μ΄λΈ”
	- ![[table_schema.png]]
- μƒν’ μ£Όλ¬Έν•κΈ° API
- μ£Όλ¬Έ μƒμ„Έ μ •λ³΄ API
- μ‚¬μ©μ λ³„ μ£Όλ¬Έ λ©λ΅ ν™•μΈ
- νΉμ • μ£Όλ¬Έμ μƒμ„Έ μ •λ³΄ ν™•μΈ

## μ„ νƒ κµ¬ν„ μ‚¬ν•­

### ν”„λ΅ νΈκ°€ μ¶”κ°€ ν•  κ²ƒ κ°™μ€ λ¶€λ¶„?
- μ£Όλ¬Έν•κΈ° λ²„νΌ
- μ°¨κ°λλ” ν¬μΈνΈ (ν•­μƒ μ „μ²΄ μ‚¬μ©μ΄λƒ μ•„λ‹λ©΄ μ„ νƒν•  μ μκ² ν•λλƒ)
	- μ‚¬μ©λλ” ν¬μΈνΈ ν”„λ΅ νΈλ΅λ¶€ν„° λ°›λ”λ‹¤. -> κ°’μ„ μμ •ν•΄μ•Ό ν•λ‹¤.
	- μ–Έμ λ‚ μ κ³µλ ν¬μΈνΈκΉμ§€λ§ μ…λ ¥ν•  μ μλ„λ΅ λ„£μ–΄μ•Ό ν•λ‹¤. (ν”„λ΅ νΈμ—μ„ μ²λ¦¬ ν•„μ”)
- μµμΆ… κ²°μ  κΈμ•΅ (κ³„μ‚° λ΅μ§ - ν”„λ΅ νΈμ—μ„ μ²λ¦¬)
- λ°±μ—”λ“λ΅ μ „λ‹¬λμ–΄μ•Ό ν•λ” κ²ƒ
	- μ‚¬μ©ν• ν¬μΈνΈ
	- μµμΆ… κ²°μ  κΈμ•΅ -> μ‚¬μ©μμ ν¬μΈνΈ κ³„μ‚° (λ°±μ—”λ“μ—μ„ μ²λ¦¬)

### ν”„λ΅ νΈμ—κ² μ§λ¬Έ
- `/orders` μ”μ²­ ν• λ²μ— μ •λ³΄λ¥Ό λ‹¤ μ£Όλ”λ° κµ³μ΄ μƒμ„Έ μ •λ³΄ APIκ°€ ν•„μ”ν• κΉ? (ν΄λΌμ΄μ–ΈνΈ λ‹¨μ—μ„ μΊμ‹±ν•λ©΄ λλ”λ°)
	- `/orders` (λ¨λ“  μ£Όλ¬Έ μ •λ³΄)
	- `/orders/{orderId}` (μ£Όλ¬Έ μƒμ„Έ)
	- orders νμ΄μ§€λ¥Ό μ• κ±°μΉκ³  κ° κ°€λ¥μ„± μμΌλ―€λ΅ (μ£Όλ¬Έ μƒμ„Έ νμ΄μ§€λ΅ λ°”λ΅ λ“¤μ–΄κ°€κ² λλ” κ²½μ°λ„ μ΅΄μ¬ν•  κ²ƒμ΄λ‹¤.) λ”°λΌμ„ ν•„μ”ν•λ‹¤.
- λ¨λ“  μ •λ³΄λ¥Ό λ‹¤ μ£Όλ” κ²ƒ vs ν„μ¬ ν•„μ”ν• μ •λ³΄λ§ μ£Όλ” κ²ƒ
	- μ–΄μ°¨ν”Ό ν•„μ”ν• κ²ƒμ€ ν”„λ΅ νΈμ—μ„ μ„ λ³„ν•κΈ° λ•λ¬Έμ— λ‹¤ λ‚΄λ ¤μ¤λ„ κ΄μ°®λ‹¤ by λ„λ°¥
	- λ·°λ” λ³€ν™”μ— λ―Όκ°ν•λ―€λ΅ κ³„μ†ν•΄μ„ λ³€κ²½λ  μ μμ§€λ§, λ·°μ λ³€ν™”μ— λ”°λΌ APIκ°€ λ³€ν™”ν•λ” κ²ƒμ€ λ°”λμ§ν•μ§€ μ•λ‹¤. urlμ— λ§λ” μ •λ³΄λ¥Ό μµλ€ν• μ κ³µν•΄μ„ λ·°κ°€ λ³€ν™”ν•  λ•λ§λ‹¤ ν•„μ”ν• μ •λ³΄λ¥Ό μ„ λ³„ν•λ” κ²ƒμ΄ λ‚«λ‹¤. by ν¬μ΄

### λ°±μ—”λ“μ—μ„ κµ¬ν„ν•΄μ•Ό ν•λ” μ‚¬ν•­
- κΈ°μ΅΄ μ• ν”λ¦¬μΌ€μ΄μ…μ— ν¬μΈνΈλ¥Ό μ¶”κ°€ν•λ‹¤.
- κ³„μ‚° μ‹μ— ν¬μΈνΈλ¥Ό μ°¨κ°ν•΄μ„ ν• μΈμ„ λ°›λ„λ΅ ν•λ‹¤.
- ν¬μΈνΈλ” ν„κΈκ³Ό 1:1 λ§¤μΉ­
- ν¬μΈνΈλ” μ–΄λ–»κ² μ κ³µλλ‚? -> μµμΆ… κ²°μ  κΈμ•΅μ—μ„ 10% ν¬μΈνΈ μ λ¦½

###  κΈ°μ΅΄ μ½”λ“ μμ • ν•„μ”
- λ„λ©”μΈ κ²€μ¦ λ΅μ§ μ¶”κ°€
- `delete cascade` μ μ™Έν–μΌλ―€λ΅ product μ‚­μ  μ‹ `cart_item`λ„ μ‚­μ ν•λ” λ΅μ§ ν•„μ”
- DB μ£Όμ† `application.properties`
	- μ„λΈ λ¨λ“μ€ κΈ°κ° -> κ°κ°μ λ°μ΄ν„°λ² μ΄μ¤κ°€ λ‹¤λ¥΄λ―€λ΅ `application.yml`μ— λ“¤μ–΄κ°€μ•Ό ν•  DB λ§ν¬λ„ λ‹¬λΌμ§€κ² λλ‹¤. κ·Έλ ‡λ‹¤λ©΄ νμΌμ„ μ—¬λ¬ κ°λ¥Ό λ§λ“¤μ–΄μ•Ό ν•λ”λ° (ν—™ν¬, λ‚, λ‹¤μ¦ μ©μΌλ΅) κ·Έλ¬λ©΄ κµ³μ΄ ν•λ‚μ λ ν¬μ—μ„ κ΄€λ¦¬ν•  μ΄μ κ°€ μ—†λ‹¤. μ—¬λ¬ κ°μ λ ν¬λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μ¤νλ ¤ λ‚μ„ μ μλ‹¤. κ·Όλ° κ·Έλ° κ²½μ°μ—λ” κµ³μ΄ μ„λΈ λ¨λ“μ„ μ‚¬μ©ν•  ν•„μ”κ°€ μμ„κΉ?
	- `application external properties`λ¥Ό μ‚¬μ©ν•μ.

## ν•¨κ» μλΌκΈ° π±

### url κΈΈμ΄ μ΅°μ •
- image_urlμ΄ 255λ” λ„λ¬΄ μ‘μ€ κ²ƒ κ°™λ‹¤. -> internet explorerμ url μµλ€ κΈΈμ΄μΈ 2048λ΅ λ³€κ²½

### μ—”ν‹°ν‹°μ™€ λ„λ©”μΈμ€ λ¶„λ¦¬λμ–΄μ•Ό ν•λ”κ°€?
- μµλ€ν• λ¶„λ¦¬ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.

### dao, repository, service, controller ν…μ¤νΈ?
- dao: `@JdbcTest`
- repository: `@JdbcTest`
- service: `@SpringBootTest`
- controller: μ• ν•¨

### DBλ¥Ό λ―Ώμ„ κ²ƒμΈκ°€? (μ„ νƒ)
- FKκ°€ κ±Έλ ¤ μμμ—λ„ findByIdλ¥Ό μν–‰ν•΄μ•Ό ν•λ”κ°€? vs κµ³μ΄ ν•  ν•„μ” μ—†λ‹¤.
	- λ‹¤μ¦: DBμ μμ™Έκ°€ μ„λΉ„μ¤ κ³„μΈµμΌλ΅ μ¬λΌμ¤λ” κ²ƒμ΄ μΆ€ λ³„λ΅λ‹¤.
	- ν—™ν¬: μΆ€ λ―Ώμγ…‹γ…‹

- equals -> idλ΅ μ •μ

### λ„λ©”μΈ λ™λ“±μ„±?

### μ–΄λ””κΉμ§€ ν™•μ¥μ„±μ„ κ³ λ ¤ν•΄μ•Ό ν• κΉ?

## λ…Όμν•  λ‚΄μ©
- [x] λ­”κ°€λ¥Ό μ°Ύμ„ μ μ—†μΌλ©΄ NOT_FOUNDλ΅ ν•λ‹¤.
- [x] ordersμ— delivery_fee μ¶”κ°€ 
	- ν”„λ΅ νΈκ°€ λ°°μ†΅λΉ„λ¥Ό μ•λ ¤μ¤μ•Ό ν•λ‚?
		- μ•λ ¤μ¤„ λ•: deliver_feeκ°€ μ μ—°ν•λ‹¤. μ΄ κ°’μ„ λ―Ώμ„ μ μλ”μ§€? μ„λ²„ λ‹¨μ—μ„ λ‹¤μ‹ κ²€μ¦ν•΄μ•Ό λ  μλ„.
		- μ• μ•λ ¤μ¤„ λ•: μ¶”κ°€ κ²€μ¦ κ³Όμ • ν•„μ” X, ν”„λ΅ νΈ λ΅μ§ μμ • X, API μμ •. deliver_feeκ°€ μ„λ²„ κ°’μΌλ΅ λ¬΄μ΅°κ±΄ κ³ μ •λλ‹¤. (λ°°μ†΅λΉ„λ¥Ό λ°”κΎΈλ ¤λ©΄ μ„λ²„λ¥Ό λ°”κΏ”μ•Ό ν•λ‹¤.)
	- ν™•μ¥λλ” μκ°„: 5λ§μ› μ΄ν•λ©΄μ€ 3000μ›, 3λ§μ› μ΄ν•λ©΄ 5000μ›.
-> ν΄λΌμ΄μ–ΈνΈ μ½μ—μ„ λ°°μ†΅λΉ„ λ°›λ” κ²ƒμΌλ΅ λ³€κ²½. λ°°μ†΅λΉ„ λ°›κ³  λ‚μ„ μ¶”κ°€ κ²€μ¦ μν–‰ν•κΈ° + μ£Όλ¬Έ λ‚΄λ ¤μ¤„ λ•λ„ λ°°μ†΅λΉ„ ν¬ν•¨ν•κΈ°λ΅.
λ§μ•½ λ°°μ†΅λΉ„ κ°’μ΄ λ‹¬λΌμ§€κ² λμ—μ„ λ•, ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ κ°κ° λ°°μ†΅λΉ„ κ³„μ‚°μ„ ν•κ² λλ‹¤λ©΄ κ°’μ΄ λ³€κ²½λλ” κ²½μ°μ— μ •ν•©μ„± λ¬Έμ κ°€ λ°μƒν•  μ μλ‹¤. (μ„λ²„μ κ°’μ€ λ°”λ€μ—λ”λ°, ν΄λΌμ΄μ–ΈνΈλ” μ• λ°”λ€λ” λ¬Έμ )
- [x] mysql μ„λ²„ νƒ€μ„ μ‹κ°„ μ„¤μ •
- [x] μ¥λ°”κµ¬λ‹ μƒν’ μ‚­μ ν•λ” κ±° batch delete (step2 λλ‚  λ¬΄λ µμ―¤ λ°μ)
	-  /cart-items DELETE μ”μ²­ -> batch deleteλ” μ£Όλ΅ μ–΄λ–»κ² Url κµ¬μ„±ν• κΉ?
	- Request: 
```json
{
	cartItemIds: [1, 3, 5, 7]
}
```
 	     - Respose: 204 No Content
- [x] μ΄ κ°€κ²©μ—μ„λ§ ν¬μΈνΈ κ³„μ‚°μ„ ν•΄μ¤μ•Ό ν•λ‹¤. (λ°°μ†΅λΉ„ μ μ™Έ)
- [x] `OrderProductResponse` λ‚΄λ¶€ κ°’μ„ `ProductResponse` λ΅ λ³€κ²½ν•κΈ°

## μ‹λ‚λ¦¬μ¤

### μ£Όλ¬Έ μ €μ¥ (POST)
1. μ…λ ¥λ λ©¤λ²„κ°€ ν•΄λ‹Ή μ¥λ°”κµ¬λ‹μ μƒν’μ ownerμ™€ λ™μΌν•μ§€ ν™•μΈν•λ‹¤. (κ²€μ¦)
2. μ‚¬μ©λ ν¬μΈνΈκ°€ λ©¤λ²„κ°€ κ°–λ” ν¬μΈνΈλ³΄λ‹¤ μ‘κ±°λ‚ κ°™μ€μ§€ ν™•μΈν•λ‹¤. (κ²€μ¦)
3. λ©¤λ²„κ°€ μ‚¬μ©ν•  ν¬μΈνΈκ°€ μ „μ²΄ μƒν’ κ°€κ²© + λ°°μ†΅λΉ„λ³΄λ‹¤ μ‘κ±°λ‚ κ°™μ€μ§€ ν™•μΈν•λ‹¤. (κ²€μ¦)
4. λ©¤λ²„μ ν¬μΈνΈλ¥Ό μ‚¬μ©ν•λ‹¤.
5. λ©¤λ²„μ ν¬μΈνΈλ¥Ό μ λ¦½ν•λ‹¤.
6. μ„ νƒλ μ¥λ°”κµ¬λ‹ μƒν’μ„ μ‚­μ ν•λ‹¤.
7. μ£Όλ¬Έμ„ μ €μ¥ν•λ‹¤.

## 2λ‹¨κ³„ λ¦¬λ·° λ„λ‘‘μ§

- `createdAt`μ„ ν„μ¬λ” Javaμ—μ„ μƒμ„±ν•΄μ£Όκ³  μλ”λ°μ”.
1. μ΄ λ¶€λ¶„μ„ Javaμ—μ„ μƒμ„±ν•λ” κ²ƒκ³Ό, DBμ—μ„ μƒμ„±ν•λ” κ²ƒμ€ μ–΄λ– ν• μ¥/λ‹¨μ μ΄ μμ„κΉμ”?
2. Javaμ—μ„ μƒμ„±ν•λ” λ°©μ‹μ„ μ„ νƒν• μ΄μ λ” λ¬΄μ—‡μΈκ°€μ”?
- λ©”μ„λ“μ μ΄λ¦„μ„ μ§€μ–΄μ¤„ λ•, κ°κ° μ–΄λ– ν• κΈ°μ¤€μΌλ΅ μ •μν–λ”μ§€, κ·Έμ— μΌκ΄€μ„±μ΄ μλ”μ§€ κ¶κΈν•λ„¤μ”!
1. μ–΄λ– ν• λ„λ©”μΈμ Controller/Service/RepositoryμΌ λ•, μ ‘λ―Έμ‚¬λ΅ κ·Έ μ–΄λ– ν• λ„λ©”μΈμ„ λ¶™μ—¬μ¤„ κ²ƒμΈκ°€?
    - ex.Β `orderApiController.createOrder()`Β vsΒ `orderApiController.create()`
2. λ¬΄μ–Έκ°€λ¥Ό λ“±λ΅ν•  λ•, μ©μ–΄λ¥Ό μ„ μ •ν•λ” κΈ°μ¤€μ€ λ¬΄μ—‡μΈκ°€?
    - ex.Β `create`Β vsΒ `register`Β vsΒ `save`
    - ex.Β `get`Β vsΒ `find`
3. μ΅°κ±΄μ— λ€ν•΄μ„λ„ μ ‘λ―Έμ‚¬λ΅ λ¶™μ—¬μ¤„ κ²ƒμΈκ°€?
    - ex.Β `get`Β vsΒ `getById`Β /Β `find`Β vsΒ `findById`